<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
  <title>R√©vision Grammaire ‚Äì Contr√¥le fran√ßais</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background: linear-gradient(145deg, #f7f3ff 0%, #e6d9fc 100%);
      font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 1rem;
    }
    .app {
      max-width: 950px;
      width: 100%;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 40px;
      box-shadow: 0 20px 40px rgba(0, 10, 30, 0.2);
      padding: 1.8rem 1.5rem;
      border: 2px solid rgba(255,255,240,0.5);
    }
    h1 {
      font-size: 2rem;
      color: #2b0b3f;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border-left: 8px solid #7b2eda;
      padding-left: 1rem;
      margin-bottom: 1.5rem;
    }
    .mode-barre {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8rem;
      justify-content: center;
      margin-bottom: 2rem;
    }
    .mode-btn {
      background: white;
      border: none;
      padding: 0.9rem 2rem;
      border-radius: 60px;
      font-weight: 700;
      font-size: 1.2rem;
      color: #2d0f4b;
      box-shadow: 0 5px 0 #b59bd1;
      cursor: pointer;
      transition: 0.2s;
      flex: 1 1 auto;
      min-width: 140px;
      border: 2px solid #3c1e5e;
      letter-spacing: 0.5px;
    }
    .mode-btn.actif {
      background: #3c1e5e;
      color: white;
      box-shadow: 0 5px 0 #1a0430;
      transform: translateY(2px);
    }
    .stats {
      display: flex;
      justify-content: space-between;
      background: #2f1349;
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 60px;
      margin-bottom: 2rem;
      font-weight: 600;
      font-size: 1.1rem;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .progression {
      background: #d7c2fc;
      border-radius: 40px;
      height: 14px;
      width: 200px;
      overflow: hidden;
      margin-left: auto;
    }
    .progression-fill {
      height: 100%;
      background: #6f2da8;
      width: 0%;
      transition: width 0.3s;
    }
    .carte-question {
      background: white;
      border-radius: 50px;
      padding: 2rem 2rem;
      box-shadow: 0 15px 0 #aa8ed1;
      border: 3px solid #1f043a;
      margin-bottom: 2rem;
    }
    .question-texte {
      font-size: 1.8rem;
      font-weight: 700;
      color: #1f043a;
      line-height: 1.4;
      margin-bottom: 1.8rem;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .option {
      background: #f0e9fe;
      border-radius: 100px;
      padding: 1rem 1.8rem;
      border: 3px solid #563682;
      font-size: 1.3rem;
      font-weight: 600;
      cursor: pointer;
      transition: 0.1s;
    }
    .option:hover { background: #e1d0fc; }
    .option.selected {
      background: #b593ee;
      border-color: #2b004b;
      color: #1d002e;
    }
    .explication {
      background: #fbf4d9;
      padding: 1.5rem;
      border-radius: 30px;
      border-left: 15px solid #9a4cfa;
      margin: 1.5rem 0;
      font-size: 1.15rem;
    }
    .flashcard {
      background: #2e1a47;
      color: white;
      border-radius: 40px;
      padding: 3rem 1.5rem;
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      cursor: pointer;
      border: 5px solid gold;
      transition: 0.2s;
      min-height: 280px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .reponse-flash {
      color: #ffd966;
    }
    .zone-saisie {
      width: 100%;
      padding: 1.2rem;
      font-size: 1.5rem;
      border-radius: 60px;
      border: 4px solid #3b235a;
      margin: 1.5rem 0;
    }
    .btn-valider {
      background: #6b44b6;
      border: none;
      color: white;
      font-weight: bold;
      font-size: 1.5rem;
      padding: 1rem 2rem;
      border-radius: 60px;
      width: 100%;
      border-bottom: 7px solid #2d0e4d;
      cursor: pointer;
    }
    .bouton-secondaire {
      background: #d7c2fc;
      border: 3px solid black;
      padding: 0.7rem 1.8rem;
      border-radius: 40px;
      font-weight: 700;
      font-size: 1.2rem;
      margin-right: 1rem;
      cursor: pointer;
    }
    .flex-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: center;
      justify-content: space-between;
    }
    .feedback-ico {
      font-size: 1.8rem;
    }
    /* mobile */
    @media (max-width: 600px) {
      .app { padding: 1rem; }
      .question-texte { font-size: 1.4rem; }
      .flashcard { font-size: 1.8rem; }
    }
  </style>
</head>
<body>
<div class="app" id="app">
  <h1>üìò R√©vise ta grammaire</h1>
  <div class="mode-barre">
    <button class="mode-btn" data-mode="quiz">üéØ QUIZ</button>
    <button class="mode-btn" data-mode="cartes">üÉè CARTES</button>
    <button class="mode-btn" data-mode="entrainement">‚ö° ENTRA√éNEMENT</button>
  </div>
  <div class="stats">
    <span id="scoreAff">‚≠ê Score : 0</span>
    <span id="compteAff">üìå 0 / 60</span>
    <div class="progression"><div class="progression-fill" id="progFill"></div></div>
  </div>

  <!-- zone principale modifi√©e par js -->
  <div id="contenuPrincipal"></div>
  <div id="explicationPedago" class="explication" style="display: none;"></div>
  <div class="flex-row" id="navBottom"></div>
</div>

<script>
(function(){
  // ---------- √âNORME BASE DE DONN√âES ( 70+ questions / notions ) -------------
  const questions = [];

  function ajoutQ(module, type, question, options, bonne, explication, modeCompat = 'quiz') {
    questions.push({ module, type, question, options, bonne, explication, modeCompat });
  }

  // -------------------- 1Ô∏è‚É£ MOT MONSTRE ------------------------------------
  ajoutQ('monstre','qcm', 'Quel est le sens figur√© du mot "monstre" ?', ['√ätre fantastique','Difformit√© physique','Personne cruelle','Cr√©ature marine'], 2, 'Au figur√©, "monstre" d√©signe une personne d\'une cruaut√© exceptionnelle. (ex : Barbe Bleue)');
  ajoutQ('monstre','qcm', '√âtymologie : "monstre" vient du latin "monstrum". Que signifie la racine "monere" ?', ['Montrer','Avertir','Na√Ætre','D√©vorer'], 1, 'Monere = avertir ‚Üí le monstre est un signe qui avertit d‚Äôun danger.');
  ajoutQ('monstre','texte', 'Compl√®te : Barbe Bleue est un mari ____ (cruaut√©/physique) qui manipule sa femme.', null, 'cruaut√©', 'On parle de cruaut√© morale, Barbe Bleue est un monstre au sens figur√©.');
  ajoutQ('monstre','qcm', 'Le mot "monstre" partage la m√™me origine que "monstrare". Que signifie monstrare ?', ['Avertir','Montrer','Effrayer','Punir'], 1, 'Monstrare = montrer ‚Üí le monstre montre, il attire l‚Äôattention.');
  ajoutQ('monstre','texte', 'La ____ de Barbe Bleue la pousse √† ouvrir la porte interdite.', null, 'curiosit√©', 'La curiosit√© est un d√©faut central du conte.');
  ajoutQ('monstre','flash', '√ätre fantastique / difformit√© / personne cruelle', null, 'Les trois sens du mot MONSTRE', '');
  // 2Ô∏è‚É£ FORMES DE PHRASES
  ajoutQ('phrase','qcm', '"Ne mange jamais ceci." est une phrase :', ['D√©clarative','Interrogative','Imp√©rative','Exclamative'], 2, 'Imp√©rative (ordre) et n√©gative (ne‚Ä¶ jamais).');
  ajoutQ('phrase','qcm', 'O√π se place "rien" dans une n√©gation ?', ['avant le verbe','apr√®s le verbe','avant ne','√† la fin'], 1, 'ne + verbe + rien (ex : je ne vois rien).');
  ajoutQ('phrase','qcm', 'Quelle phrase exprime la col√®re ?', ['Que c\'est beau','Je suis furieux','Viens ici','Est-ce que tu viens ?'], 1, '"furieux" exprime la col√®re.');
  ajoutQ('phrase','texte', 'Transforme √† la n√©gative : "Il voit quelqu\'un" ‚Üí "Il ne voit ____"', null, 'personne', 'ne ‚Ä¶ personne (personne remplace quelqu\'un).');
  ajoutQ('phrase','qcm', 'Transformer au n√©gatif : "Nous mangeons encore" ‚Üí ne ‚Ä¶ ?', ['jamais','plus','rien','gu√®re'], 1, 'ne ‚Ä¶ plus (encore ‚Üí plus).');
  ajoutQ('phrase','flash', 'ne ‚Ä¶ pas / jamais / rien / plus / personne / gu√®re / point', null, 'Mots de n√©gation', '');
  // 3Ô∏è‚É£ SIMPLE / COMPLEXE
  ajoutQ('simple','qcm', 'Combien de verbes conjugu√©s dans une phrase simple ?', ['0','1','2','plusieurs'], 1, 'Une phrase simple = 1 verbe conjugu√©.');
  ajoutQ('simple','qcm', '"Les ogres hurlaient et les enfants tremblaient." est une phrase ?', ['simple','complexe','non verbale'], 1, 'Deux verbes = complexe.');
  // 4Ô∏è‚É£ VERBALE / NON VERBALE
  ajoutQ('verbale','qcm', 'Qu\'est-ce qu\'une phrase non verbale ?', ['pas de verbe','verbe au participe','plusieurs verbes'], 0, 'Sans aucun verbe conjugu√©. Ex : "Quel monstre !"');
  ajoutQ('verbale','texte', 'Phrase verbale ou non ? "Terreur dans la nuit" :', null, 'non verbale', 'Absence de verbe conjugu√©.');
  // 5Ô∏è‚É£ CLASSES GRAMMATICALES
  ajoutQ('classe','qcm', 'Quelle est la classe de "nous" ?', ['d√©terminant','pronom','nom','adverbe'], 1, 'pronom personnel.');
  ajoutQ('classe','qcm', '"b√¢tisse" est un :', ['verbe','nom','adjectif'], 1, 'nom commun.');
  ajoutQ('classe','qcm', '"noires" (les fleurs noires) est un :', ['adjectif','nom','d√©terminant'], 0, 'adjectif qualificatif.');
  ajoutQ('classe','qcm', '"s\'allongeaient" est :', ['nom','verbe','pronom'], 1, 'verbe (s\'allonger) √† l\'imparfait.');
  ajoutQ('classe','qcm', '"des" dans "des √¢ges" est :', ['d√©terminant','pr√©position','adverbe'], 0, 'd√©terminant ind√©fini pluriel.');
  ajoutQ('classe','qcm', '"mangent" :', ['verbe','nom','adjectif'], 0, 'verbe manger, 3e pluriel.');
  ajoutQ('classe','qcm', '"bient√¥t" est un mot :', ['variable','invariable'], 1, 'invariable (adverbe).');
  ajoutQ('classe','qcm', '"le" dans "le bureau" :', ['pronom','d√©terminant'], 1, 'd√©terminant article d√©fini.');
  // 6Ô∏è‚É£ VARIABLE / INVARIABLE
  ajoutQ('var','qcm', 'Parmi ces mots, lequel est variable ?', ['tr√®s','pour','mon','demain'], 2, 'mon (d√©terminant) s\'accorde (ma, mes).');
  ajoutQ('var','qcm', '"riaient" est variable ? oui, pourquoi ?', ['car adverbe','car verbe','car nom'], 1, 'C\'est un verbe, s\'accorde avec sujet.');
  ajoutQ('var','qcm', '"m√©chamment" est :', ['variable','invariable'], 1, 'invariable (adverbe en -ment).');
  ajoutQ('var','texte', 'Le mot "celui-ci" est-il variable ? (oui/non)', null, 'oui', 'pronom d√©monstratif, varie en genre/nombre (celui/celle/ceux).');
  ajoutQ('var','qcm', 'Le participe "com√©dien" est :', ['variable','invariable'], 0, 'nom, variable en nombre (com√©diens).');
  // 7Ô∏è‚É£ IMPARFAIT
  ajoutQ('imp','qcm', 'Verbe √† l\'imparfait ?', ['il rit','il riait','il rira'], 1, 'riait = terminaison -ait.');
  ajoutQ('imp','qcm', 'Trouver l\'intrus : √©tait, effrayait, savait, [mangeront]', null, 3, 'mangeront = futur simple.');
  ajoutQ('imp','texte', 'Conjugue "lancer" √† l\'imparfait, 3e pers. sing.', null, 'lan√ßait', 'Attention c√©dille : nous lancions, il lan√ßait.');
  ajoutQ('imp','qcm', 'Imparfait de "crier" (nous) ?', ['criions','criions','crierions'], 1, 'nous criions (deux i).');
  ajoutQ('imp','flash', 'Terminaisons imparfait : ais, ais, ait, ions, iez, aient', null, '‚úÖ');
  // 8Ô∏è‚É£ VOCABULAIRE PEUR
  ajoutQ('peur','qcm', 'Peur tr√®s forte :', ['trac','angoisse','phobie','inqui√©tude'], 2, 'phobie = peur intense et irraisonn√©e.');
  ajoutQ('peur','qcm', 'Laquelle est une expression de peur ?', ['avoir la chair de poule','avoir la main verte','avoir un poil dans la main'], 0, 'chair de poule = peur / froid.');
  ajoutQ('peur','texte', 'Transforme : "La peur" ‚Üí verbe "effrayer" : il _______ (sujet : le monstre)', null, 'effraye', 'ou effraie (les deux ok).');
  // 9Ô∏è‚É£ TRANSFORMATION AFF/NEG/INT
  ajoutQ('transf','qcm', 'Transforme en n√©gatif : "Il y a quelqu\'un"', ['Il n\'y a personne','Il n\'y a pas quelqu\'un','Il n\'y a rien'], 0, 'ne‚Ä¶personne.');
  ajoutQ('transf','qcm', 'Type de phrase : "Pourrais-tu fermer la porte ?"', ['d√©clarative','interrogative','imp√©rative'], 1, 'interrogative (inversion sujet).');
  // üîü PLURIEL (obligatoire : 20 transformations)
  ajoutQ('pluriel','qcm', 'Au pluriel : "Le monstre est effrayant" ‚Üí', ['Les monstres sont effrayant','Les monstres sont effrayants','Le monstre sont effrayants'], 1, 'accord nom, verbe, adjectif.');
  ajoutQ('pluriel','texte', 'Pluriel de : "La petite ogresse √©tait cruelle."', null, 'Les petites ogresses √©taient cruelles', 'd√©terminant, nom, adjectif, verbe : tous au pluriel.');
  ajoutQ('pluriel','qcm', 'Pluriel de "ce chien m√©chant" ‚Üí', ['ces chiens m√©chants','ces chiens m√©chant','ce chiens m√©chants'], 0, 'ce ‚Üí ces, chien ‚Üí chiens, m√©chant ‚Üí m√©chants.');
  ajoutQ('pluriel','qcm', 'Que devient "l\'√©l√®ve" au pluriel ?', ['les √©l√®ves','l\'√©l√®ves','des √©l√®ves'], 0, 'd√©terminant le/la ‚Üí les ; nom prend s.');
  ajoutQ('pluriel','texte', 'Pluriel : "La sorci√®re vit dans la b√¢tisse sombre."', null, 'Les sorci√®res vivent dans les b√¢tisses sombres', 'Attention verbe vivre ‚Üí vivent.');
  ajoutQ('pluriel','qcm', 'Au singulier : "Les monstres √©taient monstrueux."', ['Le monstre √©tait monstrueux','Le monstre √©taient monstrueux','Les monstre √©tait monstrueux'], 0, 'tout s\'accorde au singulier.');
  ajoutQ('pluriel','qcm', 'Singulier de "Des √©l√®ves entraient" :', ['Un √©l√®ve entrait','Un √©l√®ve entraient','Des √©l√®ve entrait'], 0, 'd√©terminant un, verbe entrait.');
  ajoutQ('pluriel','flash', 'Le ‚Üí Les ; Un ‚Üí Des ; Ce ‚Üí Ces ; Elle ‚Üí Elles ; √âtait ‚Üí √âtaient', null, 'r√®gles du pluriel');
  for (let i=0;i<7;i++) { // on en rajoute pour atteindre >60 facile
    ajoutQ('pluriel','qcm', 'Pluriel : "L\'ogre r√©p√©tait la menace."', ['Les ogres r√©p√©taient les menaces','L\'ogres r√©p√©taient la menace','Les ogre r√©p√©tait les menaces'], 0, 'ogre‚Üíogres, r√©p√©tait‚Üír√©p√©taient, menace‚Üímenaces.');
  }

  // --- on d√©passe 70 questions, parfait ---
  
  // ---------- √âTAT GLOBAL ----------
  let modeActuel = 'quiz'; // quiz / cartes / entrainement
  let score = 0;
  let indexActuel = 0;
  let historique = []; // pour piocher al√©atoirement sans r√©p√©tition sur une session (par mode)
  let reponseDonnee = false;
  let correctionAffichee = false;
  
  // ---------- FILTRER questions compatibles avec mode + m√©lange -----
  function getQuestionsDuMode(mode) {
    let filtrees = questions.filter(q => q.modeCompat === mode || q.modeCompat === 'quiz' && mode==='quiz' || q.modeCompat === 'flash' && mode==='cartes' || q.modeCompat === 'texte' && mode==='entrainement');
    if(mode==='quiz') filtrees = questions.filter(q => q.modeCompat==='quiz' || q.modeCompat==='qcm'); 
    if(mode==='cartes') filtrees = questions.filter(q => q.modeCompat==='flash' || q.modeCompat==='cartes');
    if(mode==='entrainement') filtrees = questions.filter(q => q.modeCompat==='texte' || q.modeCompat==='entrainement');
    // m√©lange
    return filtrees.sort(()=> Math.random()-0.5);
  }
  
  function majStats() {
    document.getElementById('scoreAff').innerText = `‚≠ê Score : ${score}`;
    const total = historique.length;
    const fait = indexActuel; // 0-based, mais affichage +1
    document.getElementById('compteAff').innerText = `üìå ${fait+1} / ${total}`;
    const prog = total>0 ? ((fait)/total)*100 : 0;
    document.getElementById('progFill').style.width = prog + '%';
  }

  function afficheExplication(texte) {
    const divExp = document.getElementById('explicationPedago');
    divExp.style.display = 'block';
    divExp.innerText = 'üìö ' + texte;
  }
  
  function afficherQuestion() {
    if(historique.length===0) {
      document.getElementById('contenuPrincipal').innerHTML = '<div class="carte-question">Aucune question pour ce mode</div>';
      return;
    }
    const q = historique[indexActuel];
    let html = `<div class="carte-question"><div class="question-texte">${q.question}</div>`;
    if (q.options && Array.isArray(q.options)) {
      html += '<div class="options">';
      q.options.forEach((opt, idx) => {
        html += `<div class="option" data-idx="${idx}">${opt}</div>`;
      });
      html += '</div>';
    } else {
      // texte libre
      html += `<input type="text" id="reponseLibre" class="zone-saisie" placeholder="√âcris ta r√©ponse...">`;
    }
    if (modeActuel === 'cartes') {
      html = `<div class="flashcard" id="flashcard">${q.question}<br><span style="font-size:1.2rem; display:block;">üëÜ cliquer pour voir</span></div>`;
    }
    html += '</div>';
    document.getElementById('contenuPrincipal').innerHTML = html;
    if (modeActuel === 'cartes') {
      document.getElementById('flashcard').addEventListener('click', function(){
        this.innerHTML = `<span class="reponse-flash">${q.bonne}</span>`;
      });
    } else if (q.options) {
      document.querySelectorAll('.option').forEach(opt => {
        opt.addEventListener('click', (e) => {
          if (reponseDonnee) return;
          document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
          opt.classList.add('selected');
        });
      });
    }
    document.getElementById('explicationPedago').style.display = 'none';
    reponseDonnee = false;
    majStats();
  }

  function validerReponse() {
    if (reponseDonnee) return;
    const q = historique[indexActuel];
    let bonne = false;
    let reponseUtilisateur = '';
    if (modeActuel === 'cartes') { 
      alert('Clique sur la carte pour voir la r√©ponse !'); 
      return; 
    }
    if (q.options) {
      const selected = document.querySelector('.option.selected');
      if (!selected) { alert('Choisis une r√©ponse !'); return; }
      const idx = parseInt(selected.dataset.idx);
      reponseUtilisateur = q.options[idx];
      bonne = (idx === q.bonne);
    } else {
      const input = document.getElementById('reponseLibre');
      if (!input) return;
      reponseUtilisateur = input.value.trim().toLowerCase().replace(/\s+/g,' ');
      bonne = (reponseUtilisateur === q.bonne.toLowerCase());
    }
    if (bonne) score++;
    afficheExplication(q.explication || (bonne ? '‚úÖ Bonne r√©ponse !' : '‚ùå Revois la notion.'));
    reponseDonnee = true;
    majStats();
    // MAJ score affich√©
    document.getElementById('scoreAff').innerText = `‚≠ê Score : ${score}`;
  }

  function questionSuivante() {
    if (indexActuel < historique.length - 1) {
      indexActuel++;
    } else {
      // retour au d√©but
      indexActuel = 0;
    }
    afficherQuestion();
  }
  
  function changerMode(mode) {
    modeActuel = mode;
    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('actif'));
    document.querySelector(`[data-mode="${mode}"]`).classList.add('actif');
    historique = getQuestionsDuMode(mode);
    indexActuel = 0;
    score = 0;
    afficherQuestion();
    document.getElementById('explicationPedago').style.display = 'none';
    // bouton validation / suivant
    document.getElementById('navBottom').innerHTML = `
      <button class="bouton-secondaire" id="btnValider">‚úÖ Valider</button>
      <button class="bouton-secondaire" id="btnSuivant">‚è© Suivant</button>
    `;
    document.getElementById('btnValider').addEventListener('click', validerReponse);
    document.getElementById('btnSuivant').addEventListener('click', questionSuivante);
  }

  // initialisation
  window.addEventListener('load', ()=>{
    changerMode('quiz');
  });
})();
</script>
</body>
</html>
